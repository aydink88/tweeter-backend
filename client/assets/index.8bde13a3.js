var Q=Object.defineProperty;var E=(e,t,r)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var N=(e,t,r)=>(E(e,typeof t!="symbol"?t+"":t,r),r);import{B as H}from"./BaseCard.b1daa0dd.js";import{u as M,P as _,a as z,b as U,c as $,T as W}from"./Timeline.79e7c7ba.js";import{T as q}from"./Trends.20121560.js";import{I,u as D,d as F,f as G}from"./index.15c81381.js";import{a as s,j as u,r as b,b as B,g as Z,h as J,L as K}from"./vendor.9eb6cf8c.js";function O(e){return s(I,{...e,children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})})}function V(e){return s(I,{...e,children:s("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}const X=/(?:^|\s)(?:#)([a-zA-Z\d]+)/gm,Y=/(?:^|\s)(?:@)([a-zA-Z\d]+)/gm,tt=/\b(https?:\/\/\S*\b)/g;class et{constructor(t){N(this,"hashtags");N(this,"mentions");N(this,"urls");this.text=t,this.hashtags=this.getRegexMatches(X),this.mentions=this.getRegexMatches(Y),this.urls=this.getRegexMatches(tt)}getRegexMatches(t){const r=[];let n;for(;n=t.exec(this.text);)r.push(n[1]);return r}}function rt({letterCount:e=0}){const t=Math.floor((280-e)*100/280);let r="text-primary";return t<=50&&(r="text-warning"),t<=20&&(r="text-error"),e>280?u("span",{className:"mx-2 text-error",children:["-",e-280]}):s("div",{className:`text-xs radial-progress ${r}`,style:{"--value":t,"--size":"2rem","--thickness":"8%"},children:280-e})}var p=function(t,r){for(var n in r)t[n]=r[n];return t},nt="numeric",at="ascii",L="alpha",k="asciinumeric",y="alphanumeric",P="domain",it="emoji";function st(e,t){return e in t||(t[e]=[]),t[e]}function T(e,t,r){t[nt]&&(t[k]=!0,t[y]=!0),t[at]&&(t[k]=!0,t[L]=!0),t[k]&&(t[y]=!0),t[L]&&(t[y]=!0),t[y]&&(t[P]=!0),t[it]&&(t[P]=!0);for(var n in t){var a=st(n,r);a.indexOf(e)<0&&a.push(e)}}function ot(e,t){var r={};for(var n in t)t[n].indexOf(e)>=0&&(r[n]=!0);return r}function v(e){e===void 0&&(e=null),this.j={},this.jr=[],this.jd=null,this.t=e}v.groups={};v.prototype={accepts:function(){return!!this.t},go:function(t){var r=this,n=r.j[t];if(n)return n;for(var a=0;a<r.jr.length;a++){var i=r.jr[a][0],l=r.jr[a][1];if(l&&i.test(t))return l}return r.jd},has:function(t,r){return r===void 0&&(r=!1),r?t in this.j:!!this.go(t)},ta:function(t,r,n,a){for(var i=0;i<t.length;i++)this.tt(t[i],r,n,a)},tr:function(t,r,n,a){a=a||v.groups;var i;return r&&r.j?i=r:(i=new v(r),n&&a&&T(r,n,a)),this.jr.push([t,i]),i},ts:function(t,r,n,a){var i=this,l=t.length;if(!l)return i;for(var o=0;o<l-1;o++)i=i.tt(t[o]);return i.tt(t[l-1],r,n,a)},tt:function(t,r,n,a){a=a||v.groups;var i=this;if(r&&r.j)return i.j[t]=r,r;var l=r,o,h=i.go(t);if(h?(o=new v,p(o.j,h.j),o.jr.push.apply(o.jr,h.jr),o.jd=h.jd,o.t=h.t):o=new v,l){if(a)if(o.t&&typeof o.t=="string"){var d=p(ot(o.t,a),n);T(l,d,a)}else n&&T(l,n,a);o.t=l}return i.j[t]=o,o}};var lt="LOCALHOST",ct="COLON";function ut(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,S(e,t)}function S(e,t){return S=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},S(e,t)}var w={defaultProtocol:"http",events:null,format:C,formatHref:C,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function R(e,t){t===void 0&&(t=null);var r=p({},w);e&&(r=p(r,e instanceof R?e.o:e));for(var n=r.ignoreTags,a=[],i=0;i<n.length;i++)a.push(n[i].toUpperCase());this.o=r,t&&(this.defaultRender=t),this.ignoreTags=a}R.prototype={o:w,ignoreTags:[],defaultRender:function(t){return t},check:function(t){return this.get("validate",t.toString(),t)},get:function(t,r,n){var a=r!=null,i=this.o[t];return i&&(typeof i=="object"?(i=n.t in i?i[n.t]:w[t],typeof i=="function"&&a&&(i=i(r,n))):typeof i=="function"&&a&&(i=i(r,n.t,n)),i)},getObj:function(t,r,n){var a=this.o[t];return typeof a=="function"&&r!=null&&(a=a(r,n.t,n)),a},render:function(t){var r=t.render(this),n=this.get("render",null,t)||this.defaultRender;return n(r,t.t,t)}};function C(e){return e}function A(e,t){this.t="token",this.v=e,this.tk=t}A.prototype={isLink:!1,toString:function(){return this.v},toHref:function(t){return this.toString()},toFormattedString:function(t){var r=this.toString(),n=t.get("truncate",r,this),a=t.get("format",r,this);return n&&a.length>n?a.substring(0,n)+"\u2026":a},toFormattedHref:function(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex:function(){return this.tk[0].s},endIndex:function(){return this.tk[this.tk.length-1].e},toObject:function(t){return t===void 0&&(t=w.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject:function(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate:function(t){return t.get("validate",this.toString(),this)},render:function(t){var r=this,n=this.toFormattedHref(t),a=t.get("tagName",n,r),i=this.toFormattedString(t),l={},o=t.get("className",n,r),h=t.get("target",n,r),d=t.get("rel",n,r),f=t.getObj("attributes",n,r),c=t.getObj("events",n,r);return l.href=n,o&&(l.class=o),h&&(l.target=h),d&&(l.rel=d),f&&p(l,f),{tagName:a,attributes:l,content:i,eventListeners:c}}};function x(e,t){var r=function(a){ut(i,a);function i(l,o){var h;return h=a.call(this,l,o)||this,h.t=e,h}return i}(A);for(var n in t)r.prototype[n]=t[n];return r.t=e,r}x("email",{isLink:!0,toHref:function(){return"mailto:"+this.toString()}});x("text");x("nl");x("url",{isLink:!0,toHref:function(t){return t===void 0&&(t=w.defaultProtocol),this.hasProtocol()?this.v:t+"://"+this.v},hasProtocol:function(){var t=this.tk;return t.length>=2&&t[0].t!==lt&&t[1].t===ct}});var ht=typeof console<"u"&&console&&console.warn||function(){},j={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function ft(e,t){if(typeof t!="function")throw new Error("linkifyjs: Invalid plugin "+t+" (expects function)");for(var r=0;r<j.pluginQueue.length;r++)if(e===j.pluginQueue[r][0]){ht('linkifyjs: plugin "'+e+'" already registered - will be overwritten'),j.pluginQueue[r]=[e,t];return}j.pluginQueue.push([e,t])}var dt=x("hashtag",{isLink:!0});function mt(e){var t=e.scanner,r=e.parser,n=t.tokens,a=n.POUND,i=n.UNDERSCORE,l=t.tokens.groups,o=l.alpha,h=l.numeric,d=l.alphanumeric,f=r.start.tt(a),c=f.tt(i),m=new v(dt);f.ta(h,c),f.ta(o,m),c.ta(o,m),c.ta(h,c),c.tt(i,c),m.ta(d,m),m.tt(i,m)}ft("hashtag",mt);function vt(){const{state:{user:e},dispatch:t}=D(),r=M(),[n,a]=b.exports.useState(""),[i,l]=b.exports.useState(""),[o,h]=b.exports.useState("everyone"),d=()=>{if(!n)return;const g=new et(n);r.mutate({text:n.trim(),image:i,commentAllowed:o,hashtags:g.hashtags},{onSettled:()=>{a(""),l("")},onError:()=>{t({type:"setAlert",payload:"Creating Tweet Failed"})}})},f=g=>()=>{h(g)},m=u("div",{className:"flex justify-between",children:[u("div",{className:"flex items-center cursor-pointer icons",children:[s("span",{className:"text-accent-focus",children:s(_,{})}),u("div",{className:"dropdown dropdown-hover",children:[u("div",{className:"flex items-center text-accent-focus",tabIndex:0,children:[s(O,{}),s("span",{children:`${o==="followed"?"People you follow":"Everyone"} can reply`})]}),u("div",{tabIndex:0,className:"p-4 w-max shadow bg-base-100 dropdown-content menu rounded-box",children:[u("div",{children:[s("h5",{className:"font-semibold",children:"Who can reply?"}),s("span",{className:"text-sm text-gray-500",children:"Choose who can reply to this tweet."})]}),u("ul",{children:[u("li",{className:"flex flex-row items-center p-2 text-sm hover:bg-gray-100",onClick:f("everyone"),children:[s("div",{className:"p-1",children:s(O,{})}),"Everyone"]}),u("li",{className:"flex flex-row items-center p-2 text-sm hover:bg-gray-100",onClick:f("followed"),children:[s("div",{className:"p-1",children:s(V,{})}),"People you follow"]})]})]})]})]}),u("div",{className:"flex gap-2 items-center",children:[s(rt,{letterCount:n.length}),s("button",{className:"btn btn-primary",disabled:n.length>300,onClick:d,children:"Tweet"})]})]});return s(H,{title:"Tweet Something",actions:m,children:u("div",{className:"flex items-start my-2",children:[s("img",{src:e.avatar||F,width:"50",height:"50",className:"mask mask-squircle"}),s("textarea",{className:"mx-2 w-full textarea text-base-content",placeholder:"What's Happening",value:n,onChange:g=>{a(g.target.value)}})]})})}function jt(){const[e,t]=b.exports.useState(1),r=B();console.log(r);const{data:n,isLoading:a,isPreviousData:i,isFetching:l}=z(e),{data:o}=U(),h=Z(),d=J(G),f=c=>{d.mutate(c,{onSuccess:()=>h.invalidateQueries("recommendedUsers")})};return u("div",{className:"home flex flex-col gap-8 lg:flex-row",children:[u("div",{className:"mx-auto w-full sm:w-5/6 lg:w-2/3",children:[s(vt,{}),s($,{isPreviousData:i,page:e,setPage:t,children:s(W,{loading:a||l,tweets:n==null?void 0:n.feed})})]}),u("div",{className:"mx-auto w-full sm:w-5/6 lg:w-1/3",children:[s(q,{}),s(H,{title:"Who to Follow",children:o==null?void 0:o.recommendations.map(c=>s("div",{children:u("div",{className:"flex items-start",children:[u("div",{className:"follow-list-user",children:[u("div",{className:"follow-list-info flex",children:[s("div",{className:"avatar follow-list-avatar h-12 w-12 p-2",children:s("img",{className:"mask mask-squircle",src:c.avatar||F,alt:c.name})}),u("div",{children:[s(K,{to:`/profile/${c.handle}`,children:s("h2",{className:"custom-title follow-list-name font-medium",children:c.name})}),u("div",{className:"text-base-content/70 follow-list-count text-sm",children:[c.followerCount," "," followers"]})]})]}),s("div",{className:"text-base-content/70 follow-list-bio p-2 text-sm",children:c.bio})]}),s("div",{className:"follow-list-button ml-auto",children:s("button",{className:"btn btn-sm btn-primary",onClick:()=>{f(c.handle)},children:"Follow"})})]})},c.id))})]})]})}export{jt as default};
//# sourceMappingURL=index.8bde13a3.js.map
